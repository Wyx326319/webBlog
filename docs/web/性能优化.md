# 前端性能优化

我们首先创建一个基础的项目，其中包含两个路由

### 1. 路由懒加载
##### 不使用路由懒加载
下面是我们不使用路由懒加载引入组件，我们观察一下打包后的文件和浏览器加载资源时的情况
```js
import { createRouter, createWebHistory, type RouteRecordRaw } from 'vue-router';
import Home from '../views/HomeView.vue'
import About from '../views/AboutView.vue'
// 1. 定义路由规则（使用TypeScript类型校验）
const routes: RouteRecordRaw[] = [
  {
    path: '/',
    name: 'Home',
    component: Home
  },
  {
    path: '/about',
    name: 'About',
    component: About
  }
];

// 2. 创建路由实例
const router = createRouter({
  history: createWebHistory(import.meta.env.BASE_URL), // 使用HTML5历史模式
  routes,
});

// 3. 导出路由实例
export default router;
```
看一下打包后的图
![alt text](/web/PerformanceOptimization/image.png)
我们再看一下浏览器首页加载时，加载资源的情况
![alt text](/web/PerformanceOptimization/image-2.png)

我们可以观察到当不使用路由懒加载时，首页加载会将所有的组件一起加载

##### 使用路由懒加载
```js
import { createRouter, createWebHistory, type RouteRecordRaw } from 'vue-router';
// import Home from '../views/HomeView.vue'
// import About from '../views/AboutView.vue'
// 1. 定义路由规则（使用TypeScript类型校验）
const routes: RouteRecordRaw[] = [
  {
    path: '/',
    name: 'Home',
    component: () => import('../views/HomeView.vue')
  },
  {
    path: '/about',
    name: 'About',
    component: () => import('../views/AboutView.vue')
  }
];

// 2. 创建路由实例
const router = createRouter({
  history: createWebHistory(import.meta.env.BASE_URL), // 使用HTML5历史模式
  routes,
});

// 3. 导出路由实例
export default router;
```
跟上述步骤一样，打包看一下打包后的文件和浏览器加载资源时如何加载

##### 打包后的文件
![alt text](/web/PerformanceOptimization/image-3.png)

##### 浏览器第一次加载资源时
![alt text](/web/PerformanceOptimization/image-4.png)

##### 我们进入About页面时
![alt text](/web/PerformanceOptimization/image-5.png)


#### 总结
1. 懒加载打包后的文件会将单个页面分离出来形成单个js文件，这样减少了主包的体积  
2. 浏览器在首次加载页面时，只加载当前页面的资源，不加载未访问页面的资源  
3. 路由的懒加载是首屏优化的重要方式之一,且对于多数生产级应用而言，懒加载是必选项

